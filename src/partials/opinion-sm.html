<link rel='ractive' href='../partials/set-up.html'>

<div class="voting clearfix">
  <div class="right">
    <button class="button-mas {{d.pos === 1 ? 'active' : ''}}" on-click="+1" decorator="tip:'De acuerdo',35">
      <i class="fa fa-check"></i>
    </button>
    <button class="button-mas-mas {{d.pos === 2 ? 'active' : ''}}" on-click="+2" decorator="tip:'Muy de acuerdo',35">
      <i class="fa fa-check"></i>
      <i class="fa fa-check"></i>
    </button>
  </div>
  <div class="left">
    <button class="button-woa-woa {{d.pos === -2 ? 'active' : ''}}" on-click="-2" decorator="tip:'Muy en desacuerdo',35">
      <i class="fa fa-times"></i>
      <i class="fa fa-times"></i>
    </button>
    <button class="button-woa {{d.pos === -1 ? 'active' : ''}}" on-click="-1" decorator="tip:'En desacuerdo',35">
      <i class="fa fa-times"></i>
    </button>
  </div>
  <div class="cancel">
    {{#d.pos}}
      <button class="cancel" on-click="cancel" decorator="tip:'Cancelar',35">
        <i class="fa fa-ban"></i>
      </button>
    {{/d.pos}}
  </div>
  <div class="status">
    {{^d.pos}}
      <a class="button_opina" href="/debate/{{d._id}}">
        Opina
      </a>
    {{/d.pos}}
  </div>
</div>

<style>

.voting {
  padding-top: 10px;
  padding-bottom: 10px;
  color: #333;
  border-top: 1px solid #dadada;
  border-radius: 0px 0px 30px 9px;
}
button.cancel {
  padding: 4px 8px;
  border: solid 1px #ddd;
  color: #aaa;
  position: relative;
}
button {
  cursor: pointer;
}
button.cancel .fa-ban {
  /*position: absolute;*/
  /*top: 7px;
  left: 8px;*/
}
button:hover {
  /*color: #333;*/
  background-color: #444;
}
.active {
  background-color: #333;
}

.fa-ban {
  margin: 0;
  margin-left: 1px;
}
div.cancel {
  text-align: center;
}

.left {
  float: left;
  margin-left: 20px;
}
.right {
  float: right;
  margin-right: 20px;
}

/*.left button {
  color:#f00;
}
.right button:hover,
.left button:hover {
  background-color: #333;
}

.left button:first-child {
  position: relative;
  margin-right: 5px;
}*/

/*.fa-times {
  position: relative;
  top: -5px;
  right: 0;
}
.fa-times:nth-child(2) {
  position: absolute;
  top: 13px;
  left: 0;
}*/
/*.fa-check {
  position: relative;
  top: -5px;
}

.fa-check:nth-child(2) {
  position: absolute;
  top: 10px;
  left: 10px;
}

.single .fa-check {
  top: 0;
}

.right button:last-child {
  position: relative;
  margin-left: 5px;
}

.right button {
  color:#329841;
}*/

.status {
  padding: 0px 0;
  text-align: center;
  white-space: nowrap;
}
.button_opina {
  font-family: 'Pacifico';
  color: #878589;
  display: inline-block;
  border: 1px solid #222;
  border-color: rgba(0,0,0,.1) rgba(0,0,0,.1) rgba(0,0,0,.15);
  border-radius: 7px;
  text-decoration: none;
  margin: 2px 0;
  padding: 6px 26px;
  font-size: 14px;
  line-height: 0.8;
  text-align: center;
  white-space: nowrap;
  cursor: pointer;
  outline: none;
  /*text-shadow: 1px 2px 1px rgba(0,0,0,.2);*/
  /*box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.2), 0 1px 2px rgba(0, 0, 0, 0.05);*/
}

</style>

<script>
component.exports = {
  isolated: true,
  modal: require('../modal'),
  oninit () {
    this.on('+2', (e) => { this.pos(2) })
    this.on('+1', (e) => { this.pos(1) })
    this.on('-1', (e) => { this.pos(-1) })
    this.on('-2', (e) => { this.pos(-2) })
    this.on('cancel', (e) => { this.pos(0) })
  },
  pos (pos, skip) {
    let p = api.my.opinion.debate_pos(this.get('d._id'))
    if (pos !== p && !skip) {
      if (!api.me.birthdate || api.me.planet == null) {
        this.modal('set-up', {prevote: true, title: 'Muy rÃ¡pido, antes de opinar'}).once('teardown', () => {
          setTimeout(() => {
            this.pos(pos, !api.me.birthdate || api.me.planet == null ? true : false)
          }, 200)
        })
      } else {
        this.set('d.pos', pos)
        api.my.opinion.create({debate: this.get('d._id')}, pos)
      }
    }
  },
  decorators: {
    tip: require('../lib/decorators/tip')
  },
}
</script>
